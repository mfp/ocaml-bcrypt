NATIVE_ENABLED = true
BYTE_ENABLED = true

CFLAGS += -Wall -O3

%.o: %.c
	$(OCAMLC) $(mapprefix -ccopt, $(CFLAGS)) -c $^

bcrypt.cma bcrypt.a bcrypt.cmxa: \
	bcrypt_orig.o blowfish.o bcrypt_stub.o bcrypt.cmx bcrypt.cmo
	ocamlmklib -o bcrypt $^

.DEFAULT: bcrypt.cma bcrypt.cmxa

.PHONY: clean

clean:
	rm -f $(filter-proper-targets $(ls R, .)) *.s *.annot *.so *.a
